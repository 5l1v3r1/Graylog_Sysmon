rule "threat indicators"
when
    // Command Events
	has_field("sysmon_cmd_event") &&
	contains(to_string($message.sysmon_cmd_event), "bypass", true) ||
	contains(to_string($message.sysmon_cmd_event), "vssadmin.exe Delete Shadows", true) ||
	contains(to_string($message.sysmon_cmd_event), "vssadmin delete shadows", true) ||
	contains(to_string($message.sysmon_cmd_event), "wmic shadowcopy delete", true) ||
	contains(to_string($message.sysmon_cmd_event), "ExecutionPolicy bypass", true) ||
	contains(to_string($message.sysmon_cmd_event), "tracert", true) ||
	contains(to_string($message.sysmon_cmd_event), "ssh", true) ||
	contains(to_string($message.sysmon_cmd_event), "iex ", true) ||
	contains(to_string($message.sysmon_cmd_event), "iwr ", true) ||
	contains(to_string($message.sysmon_cmd_event), "DownloadFile", true) ||
	contains(to_string($message.sysmon_cmd_event), "DownloadString", true) ||
	contains(to_string($message.sysmon_cmd_event), "telnet", true) ||
	contains(to_string($message.sysmon_cmd_event), "psexe", true) ||
	contains(to_string($message.sysmon_cmd_event), "-NoProfile", true) ||
	contains(to_string($message.sysmon_cmd_event), "-w hidden ", true) ||
	contains(to_string($message.sysmon_cmd_event), "-windowstyle hidden", true)
then
	// set field
	set_field("suspicious_event", true);
end
